// Â© 2022 SolarWinds Worldwide, LLC. All rights reserved.
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
//  of this software and associated documentation files (the "Software"), to
//  deal in the Software without restriction, including without limitation the
//  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
//  sell copies of the Software, and to permit persons to whom the Software is
//  furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
//  all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
//  THE SOFTWARE.

import { transformPercentileStd } from "./transformer-percentile-std";
import { mockTimeSeriesData } from "./transformer.spec";

describe("TransformerPercentileStd", () => {
    it("should apply percentile standardization to time series data", () => {
        const expectedTransformedDataY = [
            7.804545454545455, 0.13181818181818183, 7.422727272727271,
            0.15000000000000002, -1.0409090909090908, 1.6590909090909092,
            0.11363636363636363, -0.8954545454545455, 0.7409090909090909,
            -1.2227272727272727, -0.2136363636363637, -0.968181818181818,
            -0.7227272727272727, -0.5954545454545455, -0.5772727272727273,
            -1.2863636363636364, 1.5318181818181817, 1.4954545454545454,
            1.8136363636363635, 2.059090909090909, -1.2863636363636364,
            -1.2863636363636364, -1.2863636363636364, -1.0045454545454544,
            0.44090909090909075, -0.27727272727272717, -1.2863636363636364,
            -1.2863636363636364, 0.7409090909090909, -0.5590909090909091,
            -0.5136363636363637, 0.14090909090909093, -1.0045454545454544,
            0.3227272727272727, -0.14090909090909093, -0.65,
            -1.2136363636363634, 1.1863636363636365, -1.2863636363636364,
            0.2954545454545454, -0.1681818181818182, -1.0318181818181817,
            -1.2045454545454544, -1.2863636363636364, 0.12272727272727273,
            -0.19545454545454552, -0.9954545454545454, -0.08636363636363634,
            -0.15909090909090912, 0.36818181818181817, -1.2863636363636364,
            -1.05, 0.6318181818181816, 0.9318181818181817, 1.2590909090909088,
            -0.44999999999999996, 0.8227272727272725, -0.9045454545454545,
            1.4499999999999997, 0.9136363636363635, 1.2409090909090905,
            1.759090909090909, -1.059090909090909, 1.4227272727272726,
            -1.1681818181818182, -0.03181818181818195, 1.3136363636363635,
            2.277272727272727, 0.9772727272727274, 0.7409090909090909,
            -1.2863636363636364, -0.8136363636363636, -1.2863636363636364,
            -1.2863636363636364, 1.7954545454545454, 1.5045454545454542,
            1.4045454545454543, 1.0499999999999998, -0.7318181818181818,
            -0.04999999999999994, 1.7954545454545454, -0.27727272727272717,
            -0.2045454545454546, 0.5136363636363636, 0.35, 1.1681818181818182,
            0.49545454545454537, -1.2863636363636364, -0.6409090909090909,
            1.1681818181818182, -0.6863636363636363, 1.3590909090909091,
            -1.059090909090909, 1.2409090909090905, -0.47727272727272724,
            1.3409090909090908, -1.2863636363636364, 1.3954545454545455,
            1.3499999999999999, -1.0681818181818181, -1.0954545454545455,
            -0.04090909090909084, 1.1318181818181818, -1.0863636363636364,
            0.8227272727272725, -0.5227272727272727, 0.4772727272727271,
            0.031818181818181746, 0.9136363636363635, 1.4499999999999997,
            1.9863636363636363, -0.8227272727272726, -0.75, -1.1681818181818182,
            -1.2863636363636364, 1.6863636363636363, 1.6772727272727268,
            -0.9227272727272727, 2.086363636363636, -0.3136363636363636,
            -0.48636363636363633, 1.3318181818181816, 0.1681818181818182,
            -1.2863636363636364, -0.2954545454545454, -0.65, 0.35,
            -0.8409090909090908, 1.15, 0.8227272727272725, 1.95,
            -1.2863636363636364, 1.3136363636363635, -0.9318181818181817,
            -1.0045454545454544, -1.1227272727272728, -1.2863636363636364,
            -1.2863636363636364, 0.35, -1.0954545454545455, 1.55,
            1.6045454545454545, 2.1045454545454545, -0.5863636363636363,
            0.1681818181818182, 1.2136363636363634, 1.068181818181818,
            0.4136363636363637, 1.9954545454545451, 1.2954545454545452,
            -1.2863636363636364, -0.7227272727272727, 1.268181818181818,
            -0.4954545454545454, -1.15, -0.8227272727272726, 0.7681818181818179,
            0.7136363636363637, 0.9045454545454545, -0.7136363636363636,
            0.09545454545454543, -1.1318181818181818, 1.0772727272727272,
            -0.5863636363636363, 1.4409090909090907, -0.3409090909090909,
            2.0045454545454544, -1.2863636363636364, 1.4499999999999997,
            -0.5590909090909091, -1.2863636363636364, -1.2863636363636364,
            0.9227272727272727, -0.15000000000000002, 0.8136363636363636,
            -1.2863636363636364, 0.10454545454545452, 0.7318181818181819, -1.05,
            0.8772727272727271, -1.2863636363636364, 0.8681818181818182,
            -1.2863636363636364, 0.9499999999999998, -1.2863636363636364,
            -0.27727272727272717, 0.8409090909090907, 0.8318181818181818,
            1.3136363636363635, 0.2954545454545454, -1.2863636363636364,
            1.695454545454545, -0.7590909090909091, 0.2409090909090908,
            -0.6681818181818181, 0.2227272727272726, 0.786363636363636,
            0.968181818181818, 0.15909090909090912, -0.7227272727272727,
            0.7681818181818179, 0.9590909090909091, -0.7681818181818182, 1.95,
            -1.2863636363636364, 1.7499999999999998, -0.3227272727272727,
            1.277272727272727, 0.13181818181818183, 1.1954545454545453,
            -0.7772727272727272, -0.9499999999999998, 1.7318181818181815,
            -1.0772727272727272, 1.9863636363636363, -1.0227272727272727,
            -1.2863636363636364, 1.15, -1.0772727272727272,
            -0.059090909090909034, 1.3772727272727272, 0.08636363636363634,
            1.0772727272727272, 0.6136363636363634, -0.5863636363636363,
            -1.2863636363636364, 0.44090909090909075, -0.9772727272727272,
            2.259090909090909, -0.5590909090909091, -0.8318181818181818,
            -1.2045454545454544, -0.9227272727272727, 0.5590909090909089,
            1.159090909090909, 1.0045454545454544, -0.6954545454545454,
            0.15909090909090912, -0.8681818181818182, -1.2863636363636364,
        ];
        const actualTransformedDataY = transformPercentileStd(
            mockTimeSeriesData,
            false
        ).map((d) => d.y);
        expect(actualTransformedDataY).toEqual(expectedTransformedDataY);
    });
});
