// Â© 2022 SolarWinds Worldwide, LLC. All rights reserved.
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
//  of this software and associated documentation files (the "Software"), to
//  deal in the Software without restriction, including without limitation the
//  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
//  sell copies of the Software, and to permit persons to whom the Software is
//  furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
//  all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
//  THE SOFTWARE.

import { transformFloatingAverage } from "./transformer-floating-average";
import { mockTimeSeriesData } from "./transformer.spec";

describe("TransformerFloatingAverage", () => {
    it("should apply floating average to time series data", () => {
        const expectedTransformedDataY = [
            10, 5.78, 8.453333333333333, 6.453333333333333, 6.191333333333334,
            6.686333333333334, 6.44347619047619, 6.30472619047619,
            6.50472619047619, 6.288726190476191, 6.3896352813852815,
            6.320468614718615, 6.3412378454878455, 6.351237845487845,
            6.3525711788211785, 6.303821178821178, 6.486174119997649,
            6.483951897775428, 6.502372950407006, 6.515872950407006,
            6.340634855168911, 6.166379372081717, 6.184778389799894,
            6.091513868679254, 6.149998656076679, 6.110411290493028,
            6.030129288453013, 6.010446102642386, 6.102623241316967,
            6.0153802437379555, 6.004744722464706, 6.02070231489706,
            5.946427729191273, 5.997151056986673, 5.956004067058045,
            5.910453252212182, 5.862197636659372, 5.9581987565004075,
            5.80363908310636, 5.853223184663471, 5.7973827196280645,
            5.7262754750785, 5.696270527602157, 5.6687225341641705,
            5.7223991372824985, 5.685370588768491, 5.623225793448274,
            5.651468484162334, 5.630564788044236, 5.635704861697915,
            5.530958414934104, 5.520778114575505, 5.585067438369715,
            5.583574091187736, 5.581022807102073, 5.4736427471041695,
            5.519508913527598, 5.412714212426085, 5.510072091279689,
            5.467997472621275, 5.466796248238313, 5.4781968924578495,
            5.3187645789997235, 5.430788105256751, 5.28374360864211,
            5.322379059659236, 5.375569939225462, 5.414252993786281,
            5.33486177995885, 5.3083997319547835, 5.186623297205111,
            5.1949882915989685, 5.154712585742943, 5.13421949752262,
            5.274250231157613, 5.244403918017401, 5.228249688060888,
            5.195808772562474, 5.092146608759445, 5.107959681020385,
            5.187481690944153, 5.06560956916824, 5.049772077583021,
            5.074581958467941, 5.049048332430378, 5.080729509753628,
            5.033984293091455, 4.924384976608884, 4.934867451981389,
            5.010582007791986, 4.899257354260425, 4.992716118882106,
            4.856417443990828, 4.962689103907393, 4.864520989925715,
            4.940248168914674, 4.788145514195496, 4.907664363059049,
            4.891562248320791, 4.755343945442759, 4.737124148510491,
            4.770916646489841, 4.818312221600392, 4.691099847505982,
            4.772838794603031, 4.689209768992204, 4.722946924194042,
            4.684802287579879, 4.719584064292784, 4.7374277124980875,
            4.752515603198379, 4.598385043623996, 4.583416897183135,
            4.548512109239911, 4.52259891901765, 4.662031201355361,
            4.648306583852536, 4.505457110979062, 4.643923432308587,
            4.506416822022291, 4.48551553043084, 4.568772262903237,
            4.498193958922924, 4.406759755938283, 4.445124513482678,
            4.410947642953137, 4.450078017903657, 4.374703308080306,
            4.464222404294611, 4.434919468104222, 4.479561932656894,
            4.297040329297777, 4.418881057187003, 4.293426969568141,
            4.277470534345676, 4.259607277932725, 4.2318728053887895,
            4.212042625461945, 4.283784792818272, 4.1909210480806385,
            4.314468868369131, 4.309180932080478, 4.323009916327014,
            4.17371543810816, 4.20214189916387, 4.245333203243926,
            4.229827753733964, 4.185053931630645, 4.258880151799709,
            4.212435282633286, 4.066602702372765, 4.076461786644949,
            4.170243760804339, 4.0660229371670695, 4.020908459433684,
            4.025834074914065, 4.098035350960795, 4.088804995988034,
            4.092936537441656, 3.999086620518961, 4.032332600158881,
            3.9546118254822025, 4.053441868025142, 3.9534624371536244,
            4.049164675203408, 3.9485467121576714, 4.057271164963089,
            3.8766732321644755, 4.005321770285134, 3.888009466403487,
            3.8344653799163546, 3.8234112217041436, 3.927075480516486,
            3.8593055624075405, 3.8999380683713722, 3.784177573558882,
            3.8455272639705407, 3.8663602122090994, 3.762434270124389,
            3.847648447871186, 3.727103772983196, 3.8254262097843537,
            3.7064173709415993, 3.8070352520328576, 3.6829196717890125,
            3.7183365763883267, 3.7659456175421675, 3.7515967819506955,
            3.770878855750039, 3.7063815741055115, 3.6148754839960837,
            3.7606092984760715, 3.6290473021318768, 3.6672364364945143,
            3.6104712400224654, 3.643353772005851, 3.6661716862176115,
            3.6671547539436617, 3.6152878273595936, 3.5620903777041275,
            3.6265876124580765, 3.6318011286235476, 3.532104696187319,
            3.666185045008543, 3.48995408276929, 3.6398128642445418,
            3.5275022112853134, 3.599957287177844, 3.5327363588553276,
            3.577110525669865, 3.467621428125311, 3.451561711179084,
            3.5773213498792273, 3.4277153521529105, 3.5767857767080717,
            3.4175626594073867, 3.3930011778550786, 3.5076121060282923,
            3.3833481704132744, 3.425636758177735, 3.4943770620098116,
            3.4204622738932278, 3.4623032808108314, 3.4346936896024274,
            3.3608131488688024, 3.31799691392116, 3.393148535334332,
            3.312465026955714, 3.4682987288498985, 3.3176112226591634,
            3.2909683987062732, 3.2630325401625093, 3.2688168653521967,
            3.331745223231862, 3.358603788521336, 3.3401189319410145,
            3.2473835163473783, 3.2852112467517736, 3.2208112058338436,
            3.191166588472918,
        ];
        const actualTransformedDataY = transformFloatingAverage(
            mockTimeSeriesData,
            false
        ).map((d) => d.y);
        expect(actualTransformedDataY).toEqual(expectedTransformedDataY);
    });
});
