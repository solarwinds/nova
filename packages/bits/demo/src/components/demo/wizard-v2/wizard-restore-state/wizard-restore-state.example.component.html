<ng-template #dialogWizard>
    <nui-dialog-header i18n-title
                       title="Restore Wizard State"
                       (closed)="closeDialog()">
    </nui-dialog-header>
    <form class="dialog-body compact-mode"
        [formGroup]="form"
          *ngIf="form">
        <nui-wizard-horizontal
            linear
            [state]="stateToRestore"
            (wizardStepsStatusChanges)="onWizardDestroy($event)"
        >
            <nui-wizard-step-v2 label="Person Details"
                                formGroupName="personDetails"
                                [stepControl]="form.get(['personDetails'])">
                <nui-form-field [control]="form.get(['personDetails','name'])"
                                class="d-block mb-4 mt-4"
                                i18n-caption
                                caption="Name">
                    <nui-textbox formControlName="name"></nui-textbox>
                    <nui-validation-message for="required"
                                            *ngIf="form.get(['user','name'])?.errors?.required"
                                            i18n>
                        This is required
                    </nui-validation-message>
                </nui-form-field>

                <nui-form-field [control]="form.get(['personDetails','privacy'])">
                    <nui-checkbox formControlName="privacy">
                        Privacy Policy
                    </nui-checkbox>
                </nui-form-field>

                <ng-template wizardStepFooter>
                    <ng-container *ngTemplateOutlet="wizardCancel"></ng-container>
                    <ng-container *ngTemplateOutlet="wizardNext"></ng-container>
                </ng-template>
            </nui-wizard-step-v2>

            <nui-wizard-step-v2 label="Organization"
                                formGroupName="organization"
                                [stepControl]="form.get(['organization'])">
                <nui-form-field [control]="form.get(['organization', 'title'])"
                                class="d-block mb-4 mt-4"
                                i18n-caption
                                caption="Organization">
                    <nui-textbox formControlName="title"></nui-textbox>
                    <nui-form-field caption="Date"
                                    class="d-block mt-4"
                                    [control]="form.get(['organization','date'])">
                        <nui-date-picker formControlName="date" i18n></nui-date-picker>
                    </nui-form-field>
                    <ng-template wizardStepFooter>
                        <ng-container *ngTemplateOutlet="wizardCancel"></ng-container>
                        <ng-container *ngTemplateOutlet="wizardPrevious"></ng-container>
                        <ng-container *ngTemplateOutlet="wizardNext"></ng-container>
                    </ng-template>
                </nui-form-field>
            </nui-wizard-step-v2>


            <nui-wizard-step-v2 formGroupName="contactDetails"
                                [stepControl]="form.get(['contactDetails'])"
                                #finalStep>

                <ng-template wizardStepLabel>
                    <span>Contact Details</span>
                </ng-template>

                <nui-form-field [control]="form.get(['contactDetails','email'])"
                                class="d-block mb-4 mt-4"
                                i18n-caption
                                caption="Email">
                    <nui-textbox type="email" formControlName="email"></nui-textbox>
                    <nui-validation-message for="required"
                                            *ngIf="form.get(['contactDetails','email'])?.errors?.required"
                                            i18n>
                        This is required
                    </nui-validation-message>

                    <nui-validation-message for="email"
                                            *ngIf="form.get(['contactDetails','email'])?.errors?.email"
                                            i18n>
                        Invalid email
                    </nui-validation-message>
                </nui-form-field>

                <nui-form-field caption="Select"
                    [control]="form.get(['contactDetails','options'])">
                    <nui-select-v2 formControlName="options">
                        <nui-select-v2-option value="Item 1">Item 1</nui-select-v2-option>
                        <nui-select-v2-option value="Item 2">Item 2</nui-select-v2-option>
                    </nui-select-v2>
                </nui-form-field>

                    <ng-template wizardStepFooter>
                        <button nui-button
                                type="button"
                                displayStyle="destructive"
                                (click)="resetStep(finalStep)">
                            Reset step
                        </button>
                        <ng-container *ngTemplateOutlet="wizardCancel"></ng-container>
                        <ng-container *ngTemplateOutlet="wizardPrevious"></ng-container>
                        <button type="button"
                                nui-button
                                displayStyle="primary"
                                [disabled]="form.get(['contactDetails','email']).invalid"
                                (click)="completeWizard(finalStep)"
                        >
                            Finish
                        </button>
                    </ng-template>
            </nui-wizard-step-v2>

            <ng-template #wizardPrevious>
                <button type="button" nuiWizardPrevious nui-button icon="caret-left">
                    Previous
                </button>
            </ng-template>

            <ng-template #wizardNext>
                <button nuiWizardNext
                        type="button"
                        nui-button
                        displayStyle="primary"
                        icon="caret-right"
                        iconRight="true"
                >Next</button>
            </ng-template>

            <ng-template #wizardCancel>
                <button type="button" nui-button (click)="closeDialog()">
                    Cancel
                </button>
            </ng-template>
        </nui-wizard-horizontal>
    </form>
</ng-template>

<button nui-button type="button" (click)="openDialog(dialogWizard)" i18n> Open dialog wizard</button>
